<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Using RxJS with Stencil.js | rohilaHarsh</title>
<meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="RxJS is mainly popular with Angular Developers. In this post, I am going to share how I used RxJS with Stencil.js to build reactive components.
Ideas in this post should be applicable to other Frontend techs too.
This post assumes familiarity with RxJS, check my RxJS basics post for that
Show me the code Reactive components A frontend component will usually have some state, let&rsquo;s represent that state by state$ (pronounced as state stream)."><meta name=generator content="Hugo 0.123.7"><meta name=robots content="index, follow"><link rel=stylesheet href=/ananke/css/main.min.31d2535c2a48db96e931588e83aa595e278fe06cfe84da3389bbbd1fafab1f4f.css><meta property="og:title" content="Using RxJS with Stencil.js"><meta property="og:description" content="RxJS is mainly popular with Angular Developers. In this post, I am going to share how I used RxJS with Stencil.js to build reactive components.
Ideas in this post should be applicable to other Frontend techs too.
This post assumes familiarity with RxJS, check my RxJS basics post for that
Show me the code Reactive components A frontend component will usually have some state, let&rsquo;s represent that state by state$ (pronounced as state stream)."><meta property="og:type" content="article"><meta property="og:url" content="https://www.rohilaharsh.in/posts/rxjs/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-22T09:29:13+05:30"><meta property="article:modified_time" content="2023-04-22T09:29:13+05:30"><meta itemprop=name content="Using RxJS with Stencil.js"><meta itemprop=description content="RxJS is mainly popular with Angular Developers. In this post, I am going to share how I used RxJS with Stencil.js to build reactive components.
Ideas in this post should be applicable to other Frontend techs too.
This post assumes familiarity with RxJS, check my RxJS basics post for that
Show me the code Reactive components A frontend component will usually have some state, let&rsquo;s represent that state by state$ (pronounced as state stream)."><meta itemprop=datePublished content="2023-04-22T09:29:13+05:30"><meta itemprop=dateModified content="2023-04-22T09:29:13+05:30"><meta itemprop=wordCount content="860"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Using RxJS with Stencil.js"><meta name=twitter:description content="RxJS is mainly popular with Angular Developers. In this post, I am going to share how I used RxJS with Stencil.js to build reactive components.
Ideas in this post should be applicable to other Frontend techs too.
This post assumes familiarity with RxJS, check my RxJS basics post for that
Show me the code Reactive components A frontend component will usually have some state, let&rsquo;s represent that state by state$ (pronounced as state stream)."><script async src="https://www.googletagmanager.com/gtag/js?id=G-EFC3FRJ2GM"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EFC3FRJ2GM",{anonymize_ip:!1})}</script><link rel=canonical href=https://www.rohilaharsh.in/posts/rxjs/><link rel=manifest href=/manifest.json><meta name=theme-color content="#000000"><link rel=apple-touch-icon href=/img/logo.png></head><body class="ma0 avenir bg-washed-yellow production"><header class="cover bg-top" style=background-image:url(https://www.rohilaharsh.in/img/rxjs.png)><div class=bg-black-60><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib home-nav"><img src=/img/logo.png class="w100 mw5-ns" alt=rohilaHarsh>
rohilaHarsh</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/projects/ title>Projects</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title>About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/contact/ title>Contact</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/fun/ title>Fun</a></li></ul><div class=ananke-socials><a href=https://github.com/HarshRohila target=_blank class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a><a href=https://www.linkedin.com/in/rohilaharsh target=_blank class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a><a href=https://stackoverflow.com/users/5798816/harsh-rohila target=_blank class="stackoverflow ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17H8.024v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav><div class="header-text tc-l pv6 ph3 ph4-ns"><h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Using RxJS with Stencil.js</h1></div></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.rohilaharsh.in/posts/rxjs/&amp;title=Using%20RxJS%20with%20Stencil.js" class="ananke-social-link linkedin no-underline" aria-label="share on LinkedIn"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div><h1 class="f1 athelas mt3 mb1 title">Using RxJS with Stencil.js</h1><p class=tracked>By <strong>Harsh Rohila</strong></p><time class="f6 mv4 dib tracked" datetime=2023-04-22T09:29:13+05:30>April 22, 2023</time>
<span class="f6 mv4 dib tracked">- 5 minutes read </span><span class="f6 mv4 dib tracked">- 860 words </span><applause-button style="width: 58px; height: 58px" multiclap=true url=https://www.rohilaharsh.in/posts/rxjs/></header><div class="nested-copy-line-height lh-copy avenir f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>RxJS is mainly popular with Angular Developers. In this post, I am going to share how I used RxJS with Stencil.js to build reactive components.</p><p>Ideas in this post should be applicable to other Frontend techs too.</p><blockquote><p>This post assumes familiarity with RxJS, check my <a href=/posts/rxjs-basics>RxJS basics post</a>
for that</p></blockquote><blockquote><p><a href=#projectlinks>Show me the code</a></p></blockquote><h2 id=reactive-components>Reactive components</h2><p>A frontend component will usually have some state,
let&rsquo;s represent that state by <code>state$</code> (pronounced as state stream).</p><blockquote><p>I am using the word &ldquo;stream&rdquo; to refer to Observable, as it&rsquo;s just a stream of values.</p></blockquote><p>This <code>state$</code> will emit values whenever the state changes. The component can subscribe to this state$ to know when to update.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>state$</span>.<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>updateComponentState</span>)
</span></span></code></pre></div><p><code>updateComponentState</code> is a function that will do changes according to the framework we are using, in Stencil.js it will update <code>@State()</code> variables so stencil knows when to update the view.</p><p>Now, let&rsquo;s try to define state$.</p><h3 id=defining-state>Defining state$</h3><p>Our component will have some initial state and the state of the component can change if a user is doing some events (like typing in an input field, or clicking a button) in our component. Let&rsquo;s represent user events by streams userEvent1$, userEvent2$, &mldr;</p><p>So we can represent the state$ as,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>state$</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>of</span>(<span style=color:#a6e22e>initialState</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>userEvent1$</span>.<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>	<span style=color:#75715e>// logic 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>).<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>update</span>(<span style=color:#a6e22e>state$</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>userEvent2$</span>.<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>	<span style=color:#75715e>// logic 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>).<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>update</span>(<span style=color:#a6e22e>state$</span>))
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>.
</span></span></code></pre></div><p>Whenever userEvent1 occurs it will run the logic 1 and will update in state$, similarly, it can work for other events.</p><p>Note that, we need to define logic 1, and logic 2 only once, then UI should work, the events will run through the logic pipeline to update the state.</p><p>Based on this understanding let&rsquo;s define all these more concretely.</p><ul><li>Because we need to update state$ on user events and those state changes should be available to the component which already subscribed to state$, we can use <code>Subject</code> for this. Using subject we can do <code>state$.next(newState)</code> and that will put the new state in state$. And this subject will need to hold some value, so we can use <code>BehaviorSubject</code>.</li><li>Because of similar reasons, we can use <code>Subject</code> for userEvent streams also, but these streams don&rsquo;t need to hold values, so it can use <code>Subject</code> only instead of <code>BehaviorSubject</code>.</li></ul><p>Let&rsquo;s define the type of our State. I am considering an example of a To-Do App, so we will store Todos.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>State</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>todos</span>: <span style=color:#66d9ef>Todo</span>[]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Todo</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>text</span>: <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Let&rsquo;s define the initial state of our component.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>initialState</span>: <span style=color:#66d9ef>State</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>todos</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;1&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;First Todo&#34;</span>
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;2&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Second Todo&#34;</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now the state$ can be defined as,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>state$</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>BehaviourSubject</span>&lt;<span style=color:#f92672>State</span>&gt;(<span style=color:#a6e22e>initialState</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>state$</span>.<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>updateComponentState</span>)
</span></span></code></pre></div><p>To avoid memory leaks, we also need to unsubscribe. Instead of unsubscribe, we can just complete the stream on disconnect/destroy of the component.</p><p>For that RxJS has <code>takeUntil</code> operator. Let&rsquo;s use that.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>state$</span>.<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>takeUntil</span>(<span style=color:#a6e22e>disconnected$</span>)
</span></span><span style=display:flex><span>).<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>updateComponentState</span>)
</span></span></code></pre></div><p>But where to put this code?</p><p>To listen for all state changes we need to do this once before rendering of the component.</p><p>Stencil having <code>componentWillLoad</code> hook for that. Let&rsquo;s put this in.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>componentWillLoad() {</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>state$</span>.<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>takeUntil</span>(<span style=color:#a6e22e>disconnected$</span>)
</span></span><span style=display:flex><span>	).<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>updateComponentState</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Let&rsquo;s define the <code>disconnected$</code> stream now, as that&rsquo;s easy. You can think of <code>disconnected$</code> as an event which occurrs in component and on that event we need to stop subscribing to state changes</p><p>Stencil.js has <code>disconnectedCallback</code> hook for knowing when the component is disconnected from the DOM.</p><p>But we need this in stream form to be able to use it with RxJS. We can use <code>Subject</code> for this, as it can emit value when the component is disconnected.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>disconnected$</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Subject</span>&lt;<span style=color:#f92672>void</span>&gt;()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>componentWillLoad() {</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>state$</span>.<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>takeUntil</span>(<span style=color:#a6e22e>disconnected$</span>)
</span></span><span style=display:flex><span>	).<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>updateComponentState</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>disconnectedCallback() {</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>disconnected$</span>.<span style=color:#a6e22e>next</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>disconnected$</span>.<span style=color:#a6e22e>complete</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now we would like the component file to be a simple view file that will just subscribe to the state$ and will emit events, some other file can have logic to manage states and events.</p><p>Let&rsquo;s create a file <code>facade.ts</code>, in that file we will have the state$.</p><blockquote><p>A facade is a design pattern to expose a simple interface masking more complex code. The idea of creating a facade is taken from this <a href=https://thomasburlesonia.medium.com/ngrx-facades-better-state-management-82a04b9a1e39 target=_blank rel=noopener>blog post</a>
.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#75715e>// facade.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>initialState</span>: <span style=color:#66d9ef>State</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>todos</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;1&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;First Todo&#34;</span>
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;2&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Second Todo&#34;</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>state$</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>BehaviourSubject</span>&lt;<span style=color:#f92672>State</span>&gt;(<span style=color:#a6e22e>initialState</span>)
</span></span></code></pre></div><h2 id=user-events>User Events</h2><p>Let&rsquo;s add a Delete todo feature. For that, the user can click on a button next to a todo to delete it.</p><p>Its template can look like below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#a6e22e>render</span>() {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>ul</span>&gt;
</span></span><span style=display:flex><span>		{<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>todos</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>todo</span>) =&gt; (
</span></span><span style=display:flex><span>			&lt;<span style=color:#f92672>li</span>&gt;
</span></span><span style=display:flex><span>				{<span style=color:#a6e22e>todo</span>.<span style=color:#a6e22e>text</span>}
</span></span><span style=display:flex><span>				&lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>createDeleteTodoHandler</span>(<span style=color:#a6e22e>todo</span>)}&gt;<span style=color:#a6e22e>X</span>&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>			&lt;/<span style=color:#f92672>li</span>&gt;
</span></span><span style=display:flex><span>		))}
</span></span><span style=display:flex><span>	&lt;/<span style=color:#f92672>ul</span>&gt;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The event handler for delete can look like the below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>deleteTodoEvent</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>createDeleteEvent</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>disconnected$</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#a6e22e>createDeleteTodoHandler</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>todo</span>: <span style=color:#66d9ef>Todo</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>deleteTodoHandler</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>deleteTodoEvent</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#a6e22e>todo</span>);
</span></span><span style=display:flex><span>	};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>deleteTodoHandler</span>;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>Where <code>events</code> is defined in the <code>facade.ts</code> file below</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#75715e>// facade.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>events</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createDeleteEvent</span>(<span style=color:#a6e22e>disconnected$</span>: <span style=color:#66d9ef>Subject</span>&lt;<span style=color:#f92672>void</span>&gt;) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>deleteEvent$</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Subject</span>&lt;<span style=color:#f92672>Todo</span>&gt;();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>deleteEvent$</span>.<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>takeUntil</span>(<span style=color:#a6e22e>disconnected$</span>)
</span></span><span style=display:flex><span>    ).<span style=color:#a6e22e>subscribe</span>((<span style=color:#a6e22e>todo</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>setState</span>({ <span style=color:#a6e22e>todos</span>: <span style=color:#66d9ef>state$.value.todos.filter</span>((<span style=color:#a6e22e>t</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>id</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>todo</span>.<span style=color:#a6e22e>id</span>) });
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>emit</span>(<span style=color:#a6e22e>todo</span>: <span style=color:#66d9ef>Todo</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>deleteEvent$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#a6e22e>todo</span>);
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=projectlinks>ProjectLinks</h2><ul><li><a href=https://codesandbox.io/p/sandbox/polished-dew-he9q05 target=_blank rel=noopener>Codesandbox</a>
- Simple To-Do app with delete feature</li><li><a href=https://github.com/HarshRohila/stencil-rxjs/tree/master/src/components/todo-app target=_blank rel=noopener>Github repo</a>
- To-Do app with many features</li></ul><ul class=pa0></ul><div class="mt6 instapaper_ignoref"><div><applause-button style="width: 58px; height: 58px" multiclap=true url=https://www.rohilaharsh.in/posts/rxjs/></div><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//a-web-dev-blog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://www.rohilaharsh.in/>&copy; rohilaHarsh 2024</a><div><div class=ananke-socials><a href=https://github.com/HarshRohila target=_blank class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a><a href=https://www.linkedin.com/in/rohilaharsh target=_blank class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a><a href=https://stackoverflow.com/users/5798816/harsh-rohila target=_blank class="stackoverflow ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17H8.024v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer><link rel=stylesheet href=https://unpkg.com/applause-button/dist/applause-button.css><script src=https://unpkg.com/applause-button/dist/applause-button.js></script><script src=https://unpkg.com/axios@1.1.2/dist/axios.min.js></script></body></html>